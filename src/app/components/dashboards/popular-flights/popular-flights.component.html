<!-- <h2>Popular Flights</h2>
<table class="table table-striped">
<thead>
<tr>
<th>Origin</th>
<th>Destination</th>
<th>Total Reservations</th>
</tr>
</thead>
<tbody>
<tr *ngFor="let flight of popularFlights">
<td>{{ flight.origin }}</td>
<td>{{ flight.destination }}</td>
<td>{{ flight.totalReservations }}</td>
</tr>
</tbody>
</table>


<ngx-charts-bar-vertical
  [results]="chartData"
  [xAxis]="true"
  [yAxis]="true"
  [legend]="false"
  [showDataLabel]="true">
</ngx-charts-bar-vertical>
 -->


  <!-- <div class="table-container">
  <h2>Popular Flights</h2>
  <table class="table">
    <thead>
      <tr>
        <th>Origin</th>
        <th>Destination</th>
        <th>Total Reservations</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let flight of popularFlights">
        <td>{{ flight.origin }}</td>
        <td>{{ flight.destination }}</td>
        <td>{{ flight.totalReservations }}</td>
      </tr>
    </tbody>
  </table>


  <ngx-charts-bar-vertical
    [results]="chartData"
    [xAxis]="true"
    [yAxis]="true"
    [legend]="false"
    [showDataLabel]="true">
  </ngx-charts-bar-vertical>
</div>  -->



<!-- <div class="table-container">
  <h2>Popular Flights</h2>
  <table class="table">
    <thead>
      <tr>
        <th>Origin</th>
        <th>Destination</th>
        <th>Total Reservations</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let flight of popularFlights">
        <td>{{ flight.origin }}</td>
        <td>{{ flight.destination }}</td>
        <td>{{ flight.totalReservations }}</td>
      </tr>
    </tbody>
  </table>

  <Improved Chart with Fixed Width -->
  <!-- <ngx-charts-bar-vertical
    [results]="chartData"
    [xAxis]="true"
    [yAxis]="true"
    [legend]="false"
    [showDataLabel]="true"
    [customColors]="customColors">
  </ngx-charts-bar-vertical>
</div> --> 

<div class="popular-flights-container">
  <!-- Header Section -->
  <div class="header-section">
    <div class="header-content">
      <div class="header-icon">
        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M3 3h18v18H3zM21 9H3M9 21V9"/>
        </svg>
      </div>
      <div class="header-text">
        <h1>Popular Flight Routes</h1>
        <p>Analytics Dashboard - Most Booked Destinations</p>
      </div>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading" class="loading-container">
    <div class="loading-spinner">
      <div class="spinner"></div>
    </div>
    <p class="loading-text">Loading flight analytics...</p>
  </div>

  <!-- Error State -->
  <div *ngIf="error && !loading" class="error-container">
    <div class="error-icon">
      <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="10"/>
        <line x1="15" y1="9" x2="9" y2="15"/>
        <line x1="9" y1="9" x2="15" y2="15"/>
      </svg>
    </div>
    <h3>Error Loading Data</h3>
    <p>Unable to load popular flights data. Please try again.</p>
    <button class="retry-btn" (click)="retryLoad()">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polyline points="23 4 23 10 17 10"/>
        <polyline points="1 20 1 14 7 14"/>
        <path d="m20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4-4.64 4.36A9 9 0 0 1 3.51 15"/>
      </svg>
      Retry
    </button>
  </div>

  <!-- Main Content -->
  <div *ngIf="!loading && !error" class="main-content">
    
    <!-- Stats Cards -->
    <div class="stats-section">
      <div class="stats-card">
        <div class="stat-icon">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M17.8 19.2 16 11l3.5-3.5C21 6 21 4.5 19.5 3s-3 0-4.5 1.5L11 8 2.8 6.2c-.5-.1-.9.1-1.1.5l-.3.5c-.2.5-.1 1 .3 1.3L9 12l-2 3H4l-1 1 3 2 2 3 1-1v-3l3-2 3.5 7.3c.3.4.8.5 1.3.3l.5-.2c.4-.3.6-.7.5-1.2z"/>
          </svg>
        </div>
        <div class="stat-content">
          <div class="stat-number">{{ popularFlights.length }}</div>
          <div class="stat-label">Total Routes</div>
        </div>
      </div>

      <div class="stats-card">
        <div class="stat-icon">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/>
            <circle cx="9" cy="7" r="4"/>
            <path d="m22 21-3-3m1-6a6 6 0 1 1-12 0 6 6 0 0 1 12 0Z"/>
          </svg>
        </div>
        <div class="stat-content">
          <div class="stat-number">{{totalReservations}}</div>
          <div class="stat-label">Total Reservations</div>
        </div>
      </div>

      <div class="stats-card">
        <div class="stat-icon">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="22,12 18,12 15,21 9,3 6,12 2,12"/>
          </svg>
        </div>
        <div class="stat-content">
          <div class="stat-number">{{avgReservationsPerRoute}}</div>
          <div class="stat-label">Avg. per Route</div>
        </div>
      </div>
    </div>

    <!-- Charts Section -->
    <div class="charts-section">
      <!-- Bar Chart -->
      <div class="chart-container bar-chart">
        <div class="chart-header">
          <h3>Reservations by Route</h3>
          <div class="chart-info">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"/>
              <path d="m9,12 2,2 4,-4"/>
            </svg>
            <span>Updated in real-time</span>
          </div>
        </div>
        <div class="chart-wrapper">
          <ngx-charts-bar-vertical
            [results]="chartData"
            [view]="view"
            [xAxis]="showXAxis"
            [yAxis]="showYAxis"
            [legend]="showLegend"
            [showXAxisLabel]="showXAxisLabel"
            [showYAxisLabel]="showYAxisLabel"
            [xAxisLabel]="xAxisLabel"
            [yAxisLabel]="yAxisLabel"
            [showDataLabel]="showDataLabel"
            [gradient]="gradient"
            [animations]="animations"
            [scheme]="colorScheme"
            [yAxisTickFormatting]="yAxisTickFormatting"
            [dataLabelFormatting]="dataLabelFormatting">
          </ngx-charts-bar-vertical>
        </div>
      </div>

      <!-- Pie Chart -->
      <div class="chart-container pie-chart">
        <div class="chart-header">
          <h3>Top Routes Distribution</h3>
          <div class="chart-info">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M12 2v20M2 12h20"/>
            </svg>
            <span>Top 6 routes</span>
          </div>
        </div>
        <div class="chart-wrapper">
          <ngx-charts-pie-chart
            [results]="pieChartData"
            [view]="pieView"
            [legend]="true"
            [legendPosition]="legendPosition"
            [labels]="true"
            [doughnut]="false"
            [gradient]="gradient"
            [animations]="animations"
            [scheme]="colorScheme">
          </ngx-charts-pie-chart>
        </div>
      </div>
    </div>

    <!-- Data Table -->
    <div class="table-section">
      <div class="table-header">
        <h3>Flight Routes Details</h3>
        <div class="table-info">
          <span class="route-count">{{ popularFlights.length }} routes</span>
        </div>
      </div>
      
      <div class="table-container">
        <table class="modern-table">
          <thead>
            <tr>
              <th>Route</th>
              <th>Origin</th>
              <th>Destination</th>
              <th>Reservations</th>
              <th>Popularity</th>
              <th>Trend</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let flight of popularFlights; let i = index" 
                class="table-row"
                [style.animation-delay]="i * 0.1 + 's'">
              <td class="route-cell">
                <div class="route-visual">
                  <span class="airport-code">{{ flight.origin }}</span>
                  <div class="route-arrow">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <line x1="5" y1="12" x2="19" y2="12"/>
                      <polyline points="12,5 19,12 12,19"/>
                    </svg>
                  </div>
                  <span class="airport-code">{{ flight.destination }}</span>
                </div>
              </td>
              <td class="origin-cell">
                <div class="airport-info">
                  <span class="airport-name">{{ flight.origin }}</span>
                </div>
              </td>
              <td class="destination-cell">
                <div class="airport-info">
                  <span class="airport-name">{{ flight.destination }}</span>
                </div>
              </td>
              <td class="reservations-cell">
                <div class="reservation-count">
                  <span class="count-number">{{ flight.totalReservations }}</span>
                  <span class="count-label">bookings</span>
                </div>
              </td>
              <td class="popularity-cell">
                <span class="popularity-badge" [ngClass]="getPopularityClass(flight.totalReservations)">
                  {{ getPopularityLevel(flight.totalReservations) }}
                </span>
              </td>
              <td class="trend-cell">
                <span class="trend-icon">{{ getTrendIcon(flight.totalReservations) }}</span>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

